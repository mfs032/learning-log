#  POSIX 扩展正则表达式（ERE）

```
对应工具：
grep -E、sed -E、awk
```

## 基本元字符

### 1.字符与转义匹配

```
. 匹配任意单个字符(除换行符)
\ 转义特殊字符(如匹配.需要\.)
[abc] 匹配a,b,c三个中的任意一个
[^abc] 匹配非a,b,c三个的任意字符
[a-z] 匹配a到z的任意字符
```

### 2.量词

```
* 匹配前面的字符0次或多次er*or,[abc]*
+ 匹配前面的字符1次或多次
? 匹配前面的字符0次或者1次
{n} 匹配前面的字符恰好n次
{n,} 匹配前面的字符n次或超过n次
{n,m} 匹配前面的字符n次到m次
```

### 3.预定义字符

```
[:space:] 空白字符
[:alpha:] 字母，包括大小写
[:digit:] 数字，0-9
[:alnum:] 字母和数字
[:lower:] 小写字母
[:upper:] 大写字母

空白字符：
空格： 
制表符：\t是Tab
换行符：\n换行到新一行
回车符：\r回到行首
```

### 4.锁定匹配位置

```
^ 行首匹配
$ 行尾匹配
```

### 5.分组与选择

```
() 捕获分组
(?:) 非捕获分组
| 或操作

()有两个作用分组，捕获
1. 分组
将多个字符或者表达式组成一个独立的单元，对这个单元应量词
(ab)+ 匹配一个或多个连续的ab，例如ab,abab
(ab|cd|ef)+ 匹配一个或多个ab或者cd或者ef，例如efababcd

2.捕获
http://(www\.){1}([[:alnum:]]?[A-Za-z1-9]+)(\.com) #括起来的部分被捕获，可以被引用,例如第二个被捕获的部分可以使用$2或者\2来引用。

(?:)非捕获分组
只有分组一个功能，没有捕获的功能，性能优化


关于引用：引用捕获组的方式取决于具体工具或编程语言的实现，而不一定使用$1或者\1
```

## 使用场景

```
过滤日志中的ERROR行和WARN行(使用grep -E)
日志示例tomcat
INFO 2025-09-08 10:00:00 [Thread-1] - 服务启动成功
ERROR 2025-09-08 10:05:00 [Thread-2] - 数据库连接失败
WARN 2025-09-08 10:10:00 [Thread-3] - 内存使用率超过80%
] grep -E '^ERROR|^WARN' /log/tomcat/catalina.out

提取nginx访问日志的IP地址(awk)
] awk '{count[$7]++}END{for (ip in count) { print ip,count[ip]}}' | sort -r -k 2 | head -10

批量修改配置文件中的端口号
listen 80;
listen 443 ssl;
] sed -i -E 's/listen[[:space:]]+80[[:space:]]*;/listen 8080;/g' /etc/nginx/nginx.conf

排除nginx配置文件中的注释行和空行
] grep -E '^[[:space:]]*#|^$' /etc/nginx/nginx.conf
```



#  Perl 兼容正则表达式（PCRE）

```
用于Perl、PHP、Python、Nginx(只用了子集)等

向后兼容：支持所有基本正则表达式
扩展：功能更丰富
```

## 1.字符匹配

```
. 匹配任意字符(默认不包括换行)
\d 数字[0-9]
\D 非数字[^0-9]
\w 单词字符[0-9a-zA-Z_]字母数字下划线
\W 非单词字符[^0-9a-zA-Z]
\s 空白字符
\S 非空白字符
```

## 2.量词

```
*
+
?
{n}
{n,}
{n,m}
```

## 3.分组与捕获

```
(exp) 捕获分组
(?:exp) 非捕获分组
$1 \1 引用分组
关于引用：引用捕获组的方式取决于具体工具或编程语言的实现，而不一定使用$1或者\1
```



# POSIX 基础正则表达式（BRE）(了解)

```
需要转义：很多功能需要通过转义字符激活
```

## 1.字符匹配

```
. 匹配任意单个字符
[abc] 匹配a,b,c中的任意一个
[^abc]
[a-z]
```

## 2.锁定匹配位置

```
^
$
```

## 3.重复匹配

```
\{n\} 匹配n次
\{n,\} 匹配至少n次
\{n,m\} 匹配n到m次
*	前导符出现0次或多次
没有?和+
```

## 4.分组与捕获

```
\(abc\) 分组和捕获
\1	引用
关于引用：引用捕获组的方式取决于具体工具或编程语言的实现，而不一定使用$1或者\1
```

