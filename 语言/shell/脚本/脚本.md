### Ubuntu添加nginx官方源

```shell
下载公钥
curl -fsSL https://nginx.org/keys/nginx_signing.key | sudo gpg --dearmor -o /etc/apt/keyrings/nginx-archive-keyring.gpg

添加官方源
echo "deb [signed-by=/etc/apt/keyrings/nginx-archive-keyring.gpg] http://nginx.org/packages/ubuntu `lsb_release -cs` nginx" | sudo tee /etc/apt/sources.list.d/nginx.list
```

### Ubuntu添加zabbix官网源

```shell
curl -fsSL https://repo.zabbix.com/zabbix-official-repo.key | sudo gpg --dearmor -o /etc/apt/keyrings/zabbix-archive-keyring.gpg

echo "deb [signed-by=/etc/apt/keyrings/zabbix-archive-keyring.gpg] https://repo.zabbix.com/zabbix/6.0/ubuntu `lsb_release -cs` main" | sudo tee /etc/apt/sources.list.d/zabbix.list
```









## 官网迁移

```shell
新机安装nginx

Utuntu
]# echo "deb http://nginx.org/packages/ubuntu `lsb_release -cs` nginx" | sudo tee /etc/apt/sources.list.d/nginx.list
]# apt update
]# apt install -y nginx

配置官网
]# unzip .zip压缩包 -d /var/www/目录/
]# chown www-data:www-data -R /var/www/
]# chmod 755 -R /var/www/

配置官网信息
]# ls /etc/nginx
该目录下有两个文件夹
```

```shell
#ubuntu迁移脚本，和zip打包的网站文件压缩到一起，传输到服务器上
#!/bin/bash

if [ "$(id -u)" -ne "0" ];then
	echo "请使用root用户执行脚本"
	exit 1
fi


echo "deb http://nginx.org/packages/ubuntu `lsb_release -cs` nginx" >> /etc/apt/sources.list.d/nginx.list

apt update

apt install -y nginx

if [ $(ss -ntulp | grep nginx | wc -l) -gt "0" ];then
	echo "nginx安装成功"
else
	echo "nginx安装失败"
	exit 1
fi

mkdir /var/www/website

apt install -y unzip

unzip ./cloudfuture_technology.zip -d /var/www/website

chown -R www-data:www-data /var/www
chmod -R 755 /var/www

cat <<'EOF' > /etc/nginx/sites-available/mbbjfcqhlt.yuurw.com.conf
server {
    listen 80;                  # 监听 80 端口（HTTP）
    server_name mbbjfcqhlt.yuurw.com;        # 绑定的域名（如 example.com 或 sub.example.com）
    root /var/www/website;      # 网站根目录
    index index.html index.htm; # 默认首页文件

    # 日志配置
    access_log /var/log/nginx/mbbjfcqhlt.yuurw.com.access.log;
    error_log /var/log/nginx/mbbjfcqhlt.yuurw.com.error.log;

    # 处理静态文件的默认规则（可选）
    location / {
        try_files $uri $uri/ =404;  # 找不到文件时返回 404
    }
}
EOF

ln -s /etc/nginx/sites-available/mbbjfcqhlt.yuurw.com.conf /etc/nginx/sites-enabled/

nginx -t
if [ $? -ne "0" ];then
	echo "nginx配置不正确"
	exit 1
fi

systemctl reload nginx
if [ $? -eq "0" ];then
	echo "nginx启动成功"
else
	echo "nginx启动失败"
	exit 1
fi
```

## 官网部署zabbix-agent

```shell
1、安装 Zabbix Agent
（1）下载 Zabbix 软件包库
wget https://repo.zabbix.com/zabbix/6.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.0-4+ubuntu`lsb_release -rs`_all.deb
（2）安装软件包库
dpkg -i zabbix-release_6.0-4+ubuntu20.04_all.deb
（3）更新软件包列表
（4）安装 Zabbix Agent

2、配置 Zabbix Agent
（1）借鉴其他主机配置

3、启动 Zabbix Agent
（1）开机自启

4、在 Zabbix Server 上添加主机
```

```shell
#!/bin/bash
#ubuntu部署zabbix

#任何一条命令失败，退出脚本
set -e

#下载公钥
curl -fsSL https://repo.zabbix.com/zabbix-official-repo.key | sudo gpg --dearmor -o /etc/apt/keyrings/zabbix-archive-keyring.gpg
#添加官方源
echo "deb [signed-by=/etc/apt/keyrings/zabbix-archive-keyring.gpg] https://repo.zabbix.com/zabbix/6.0/ubuntu `lsb_release -cs` main" | sudo tee /etc/apt/sources.list.d/zabbix.list
#更新源
apt update

#安装zabbix-agent
apt install -yq zabbix-agent

#创建备份文件夹
mkdir -p /var/backups

#备份主配置文件
cp -f /etc/zabbix/zabbix_agentd.conf /etc/zabbix/zabbix_agentd.conf.bak
cp -f /etc/zabbix/zabbix_agentd.conf /var/backups/zabbix_agentd.conf.bak

#修改配置文件
cat <<EOF > /etc/zabbix/zabbix_agentd.conf
PidFile=/var/run/zabbix/zabbix_agentd.pid
LogFile=/var/log/zabbix/zabbix_agentd.log
LogFileSize=0
EnableRemoteCommands=1
Server=proxy.mryas6.com
ListenPort=32248
ServerActive=proxy.mryas6.com:28690
Hostname=website-eth0-$(hostname -I | awk '{print $1}')
Include=/etc/zabbix/zabbix_agentd.d/*.conf
UnsafeUserParameters=1
EOF

#重启服务
systemctl restart zabbix-agent

systemctl enable zabbix-agent

echo "success"
```



